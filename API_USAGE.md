# دليل استخدام واجهة برمجة التطبيقات (API)

## المصادقة

هناك طريقتان للمصادقة مع واجهة برمجة التطبيقات:

### 1. مصادقة الرمز (Token Authentication)

1. قم بتسجيل الدخول إلى التطبيق من خلال واجهة المستخدم
2. قم بزيارة: `http://127.0.0.1:8000/api/token/` للحصول على رمز المصادقة الخاص بك
3. استخدم هذا الرمز في جميع طلبات API من خلال إضافة رأس HTTP:
   ```
   Authorization: Token your_token_here
   ```

مثال باستخدام curl:
```bash
curl -H "Authorization: Token your_token_here" http://127.0.0.1:8000/api/messages/
```

### 2. مصادقة الجلسة (Session Authentication)

1. قم بتسجيل الدخول إلى التطبيق من خلال واجهة المستخدم
2. استخدم ملفات تعريف الارتباط (cookies) التي تم إنشاؤها للمصادقة
3. تأكد من إرسال ملفات تعريف الارتباط مع كل طلب API

مثال باستخدام curl:
```bash
curl -b cookies.txt -c cookies.txt http://127.0.0.1:8000/api/messages/
```

## نقاط نهاية الرسائل

### الحصول على الرسائل

```
GET /api/messages/
```

معلمات الاستعلام:
- `user`: تصفية الرسائل حسب اسم المستخدم
- `page`: رقم الصفحة (افتراضي: 1)
- `page_size`: عدد الرسائل في الصفحة (افتراضي: 10، الحد الأقصى: 100)

مثال:
```
GET /api/messages/?user=john&page=1&page_size=20
```

### إرسال رسالة جديدة

```
POST /api/messages/
```

البيانات المطلوبة:
```json
{
  "receiver": "user_id",
  "content": "محتوى الرسالة"
}
```

### تحديث رسالة

```
POST /api/messages/{id}/update_message/
```

البيانات المطلوبة:
```json
{
  "content": "محتوى الرسالة الجديد"
}
```

### حذف رسالة

```
DELETE /api/messages/{id}/delete_message/
```

## ملاحظات هامة

1. يجب أن تكون مصادقًا لاستخدام أي من نقاط النهاية المذكورة أعلاه.
2. يمكنك فقط تحديث أو حذف الرسائل التي أرسلتها.
3. عند استخدام مصادقة الجلسة، تأكد من إرسال رمز CSRF مع طلبات POST/PUT/DELETE.
